{% extends 'index.html' %}
{% block ace-content %}
<!-- ACE Editor -->   
<script src="http://cdn.bootcss.com/ace/1.2.4/ace.js"></script>
<script src="http://cdn.bootcss.com/ace/1.2.4/ext-language_tools.js"></script>
<script src="http://cdn.bootcss.com/ace/1.2.4/ext-old_ie.js"></script>
<script src="http://cdn.bootcss.com/ace/1.2.4/theme-monokai.js"></script> 
<link href="/static/dist/css/bootstrap-multiselect.css" rel="stylesheet">
<script src="/static/dist/js/bootstrap-multiselect.js"></script>
<script type="text/javascript" src="/static/dist/js/bootstrap-notify.js"></script>
<link href="/static/dist/css/fileinput.css" media="all" rel="stylesheet" type="text/css" />
<script src="/static/dist/js/fileinput.js" type="text/javascript"></script>
<style type="text/css"> 
	td.details-control {
	    background: url('/static/img/details_open.png') no-repeat center center;
	    cursor: pointer;
	}
	tr.shown td.details-control {
	    background: url('/static/img/details_close.png') no-repeat center center;
	} 
	#compile-editor {
		/* position: absolute; */
	width: 100%;
	height: 400px;
   }		
</style>	
{% endblock %}
{% block page-content %}


    <div id="page-wrapper">

			<div class="row">
				<div class="col-lg-12">
					<h1 class="page-header">Dashboard</h1>
				</div>
				<!-- /.col-lg-12 -->
			</div>
			<!-- /.row -->
			<div class="row">
				<div class="col-lg-3 col-md-6">
					<div class="panel panel-primary">
						<div class="panel-heading">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-database fa-5x"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="huge">{{projectTotal.assets}}</div>
									<div>设备资产</div>
								</div>
							</div>
						</div>
						<a href="/assets_list">
							<div class="panel-footer">
								<span class="pull-left">查看所有</span> <span class="pull-right"><i
									class="fa fa-arrow-circle-right"></i></span>
								<div class="clearfix"></div>
							</div>
						</a>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="panel panel-green">
						<div class="panel-heading">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-github-alt fa-5x"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="huge">{{projectTotal.project}}</div>
									<div>部署项目</div>
								</div>
							</div>
						</div>
						<a href="/deploy_list/">
							<div class="panel-footer">
								<span class="pull-left">查看所有</span> <span class="pull-right"><i
									class="fa fa-arrow-circle-right"></i></span>
								<div class="clearfix"></div>
							</div>
						</a>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="panel panel-yellow">
						<div class="panel-heading">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-clock-o fa-5x"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="huge">{{projectTotal.cron}}</div>
									<div>计划任务</div>
								</div>
							</div>
						</div>
						<a href="/cron_list/1/">
							<div class="panel-footer">
								<span class="pull-left">查看所有</span> <span class="pull-right"><i
									class="fa fa-arrow-circle-right"></i></span>
								<div class="clearfix"></div>
							</div>
						</a>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="panel panel-red">
						<div class="panel-heading">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-tasks  fa-5x"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="huge">{{projectTotal.playbook}}</div>
									<div>PlayBook</div>
								</div>
							</div>
						</div>
						<a href="/apps/">
							<div class="panel-footer">
								<span class="pull-left">查看所有</span> <span class="pull-right"><i
									class="fa fa-arrow-circle-right"></i></span>
								<div class="clearfix"></div>
							</div>
						</a>
					</div>
				</div>
			</div>
			<!-- /.row -->
			<div class="row">
				<div class="col-lg-12">
					<div class="panel panel-default">
						<div class="panel-heading">
							<i class="fa fa-bar-chart-o fa-fw"></i> 网络拓扑图
						</div>
						<!-- /.panel-heading -->
						<div class="panel-body">
                            <canvas id="canvas" width="1100" height="500"></canvas>
						</div>
						<!-- /.panel-body -->
					</div>

				</div>
				<!-- /.col-lg-8 -->
<!-- 				<div class="col-lg-4">
                    <div class="chat-panel panel panel-default">
                        <div class="panel-heading">
                            <i class="fa fa-comments fa-fw"></i> ChatOps
                        </div>
                        /.panel-heading
                        <div class="panel-body">
                            <ul class="chat" id="chatTalk">
                            </ul>
                        </div>
                        /.panel-body
                        <div class="panel-footer">
                            <div class="input-group">
                                <input id="inputChatRoom" type="text" class="form-control input-sm" placeholder="Type your message here..." />
                                <span class="input-group-btn">
                                    <button class="btn btn-warning btn-sm" id="btnChatRoom">
                                        Send
                                    </button>
                                </span>
                            </div>
                        </div>
                        /.panel-footer
                    </div>
				</div> -->
				<!-- /.col-lg-4 -->
			</div>
			<!-- /.row -->
		</div>


    <script src="/static/js/jtopo-0.4.8-min.js"></script>
    <script type="text/javascript">
		$(document).ready(function(){
            var canvas = document.getElementById('canvas');
            var stage = new JTopo.Stage(canvas);
            var scene = new JTopo.Scene(stage);
            scene.background = '/static/img/bg.jpg'
             {% for node in nodelist %}
                 {%  if node.type == "firewall" %}
                     new firewall("{{node.name}}")
                 {%  elif node.type == "netaddr" %}
                     new netaddr("{{node.name}}")
                 {%  elif node.type == "switch" %}
                     new sw("{{node.name}}")
                  {% endif %}
             {% endfor %}
            {% for edge in edges %}

                    linkNode({{ edge.0.name }},{{ edge.1.name }})
             {% endfor %}
             scene.doLayout(JTopo.layout.TreeLayout('down', 30, 107));


            function linkNode(nodeA, nodeZ, f){
                    var link;
                    if(f){
                        link = new JTopo.FoldLink(nodeA, nodeZ);
                    }else{
                        link = new JTopo.Link(nodeA, nodeZ);
                    }
                    link.direction = 'vertical';
                    scene.add(link);
                    return link;
                }
           function firewall(name){
                    var node = new JTopo.Node();
                    node.setImage('/static/icon/h3c/h3_firewall.gif', true);
                    node.text=name;
                    // node.setLocation(x, y);
                     node.textPosition = 'Bottom_Center';
                    scene.add(node);
                    return node;
                }
           function netaddr(name){
                    var node = new JTopo.Node();
                    node.setImage('/static/icon/h3c/h3_cloud.gif', true);
                    node.text=name;
                    // node.setLocation(x, y);
                     node.textPosition = 'Bottom_Center';
                    scene.add(node);
                    return node;
                }
            function sw(name){
                    var node = new JTopo.Node();
                    node.setImage('/static/icon/h3c/h3_switch_s5000.gif', true);
                    node.text=name;
                     node.textPosition = 'Bottom_Center';
                    // node.setLocation(x, y);
                    scene.add(node);
                    return node;
                }
        });
    </script>


{% endblock %}